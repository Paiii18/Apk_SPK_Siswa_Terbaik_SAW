# -------------------------------------------
# Skrip Optimasi RAM dan Penghapusan Bloatware Windows 11
# -------------------------------------------

# 1. Hentikan aplikasi startup yang tidak penting
Get-CimInstance -ClassName Win32_StartupCommand | ForEach-Object {
    Write-Host "Menonaktifkan startup: $($_.Name)"
    Disable-ScheduledTask -TaskName $_.Name -ErrorAction SilentlyContinue
}

# 2. Nonaktifkan background apps yang boros RAM
$apps = @(
    "Microsoft.BingNews",
    "Microsoft.BingWeather",
    "Microsoft.GetHelp",
    "Microsoft.Getstarted",
    "Microsoft.MicrosoftOfficeHub",
    "Microsoft.MicrosoftSolitaireCollection",
    "Microsoft.MicrosoftStickyNotes",
    "Microsoft.MixedReality.Portal",
    "Microsoft.People",
    "Microsoft.SkypeApp",
    "Microsoft.Todos",
    "Microsoft.XboxApp",
    "Microsoft.XboxGameOverlay",
    "Microsoft.XboxGamingOverlay",
    "Microsoft.XboxIdentityProvider",
    "Microsoft.XboxSpeechToTextOverlay",
    "Microsoft.ZuneMusic",
    "Microsoft.ZuneVideo",
    "Microsoft.YourPhone"
)

foreach ($app in $apps) {
    Write-Host "Menghapus aplikasi: $app"
    Get-AppxPackage -Name $app -AllUsers | Remove-AppxPackage -ErrorAction SilentlyContinue
    Get-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -like "$app"} | Remove-AppxProvisionedPackage -Online -ErrorAction SilentlyContinue
}

# 3. Nonaktifkan fitur animasi dan efek visual
Write-Host "Menonaktifkan animasi visual..."
Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name "UserPreferencesMask" -Value ([byte[]](0x90,0x12,0x03,0x80,0x10,0x00,0x00,0x00))
Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" -Name "VisualFXSetting" -Value 2

# 4. Bersihkan temporary files
Write-Host "Membersihkan temporary files..."
Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item "C:\Windows\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue

# 5. Restart Explorer untuk apply beberapa perubahan
Stop-Process -Name explorer -Force
Start-Process explorer